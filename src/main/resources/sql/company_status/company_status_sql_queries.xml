<sql-statements>
  <valid-companies-query>
    <sql-statement>
SELECT INCORPORATION_NUMBER
FROM CORPORATE_BODY CB
WHERE CB.TRADING_STATUS_TYPE_ID IN (1, 2)
   OR CB.ACTION_CODE_DATE >= TO_DATE('20100101', 'YYYYMMDD') AND CB.ACTION_CODE_TYPE_ID >= 9000
   OR EXISTS(SELECT 1
             FROM TRANSACTION TRANS
             WHERE TRANS.CORPORATE_BODY_ID = CB.CORPORATE_BODY_ID
               AND TRANS.TRANSACTION_TYPE_ID IN (541, 542)
               AND TRANS.TRANSACTION_STATUS_TYPE_ID = 9
               AND TRANS.TRANSACTION_STATUS_DATE = TO_DATE('05/01/2010', 'DD/MM/YYYY'))
    </sql-statement>
  </valid-companies-query>
  <status-classification-queries>
    <sql-statement status="dissolved">
SELECT CB.INCORPORATION_NUMBER AS INCORPORATION_NUMBER
FROM CORPORATE_BODY CB
WHERE CB.ACTION_CODE_TYPE_ID = 9000
  AND CB.TRADING_STATUS_TYPE_ID = 3
  AND CB.ACTION_CODE_DATE >= TO_DATE('30-DEC-2009', 'DD-MON-YYYY')
    </sql-statement>
    <sql-statement status="liquidation">
SELECT CB.INCORPORATION_NUMBER AS INCORPORATION_NUMBER
FROM CORPORATE_BODY CB
WHERE CB.ACTION_CODE_TYPE_ID IN (7001, 7002, 7101, 7401, 7402, 7403)
   OR CB.ACTION_CODE_TYPE_ID = 7701
    AND EXISTS(SELECT 1
               FROM INSOLVENCY_CASE IC
               WHERE CB.CORPORATE_BODY_ID = IC.CORPORATE_BODY_ID
                 AND INSOLVENCY_CASE_END_DATE > SYSDATE
                 AND INSOLVENCY_CASE_TYPE_ID IN (1, 2, 3))
    </sql-statement>
    <sql-statement status="insolvency-proceedings">
SELECT CB.INCORPORATION_NUMBER AS INCORPORATION_NUMBER
FROM CORPORATE_BODY CB
WHERE CB.ACTION_CODE_TYPE_ID = 7404
   OR CB.ACTION_CODE_TYPE_ID = 7701
    AND
      EXISTS(SELECT 1
             FROM INSOLVENCY_CASE IC
             WHERE IC.CORPORATE_BODY_ID = CB.CORPORATE_BODY_ID
               AND IC.INSOLVENCY_CASE_TYPE_ID IN (5, 6, 16)
               AND IC.INSOLVENCY_CASE_END_DATE > SYSDATE)
    AND
      EXISTS(SELECT 1
             FROM INSOLVENCY_CASE IC
             WHERE IC.CORPORATE_BODY_ID = CB.CORPORATE_BODY_ID
               AND IC.INSOLVENCY_CASE_TYPE_ID IN (7, 8, 13)
               AND IC.INSOLVENCY_CASE_END_DATE > SYSDATE)
   OR SUBSTR(CB.INCORPORATION_NUMBER, 1, 2) NOT IN ('SC', 'SA', 'SF', 'SL', 'SZ', 'SP', 'SO', 'SR', 'GS')
    AND EXISTS(SELECT 1
               FROM INSOLVENCY_CASE IC
               WHERE IC.CORPORATE_BODY_ID = CB.CORPORATE_BODY_ID
                 AND IC.INSOLVENCY_CASE_TYPE_ID = 5
                 AND IC.INSOLVENCY_CASE_END_DATE > SYSDATE)
    AND EXISTS(SELECT 1
               FROM INSOLVENCY_CASE IC
               WHERE IC.CORPORATE_BODY_ID = CB.CORPORATE_BODY_ID
                 AND IC.INSOLVENCY_CASE_TYPE_ID IN (6, 16)
                 AND IC.INSOLVENCY_CASE_END_DATE > SYSDATE)
    </sql-statement>
    <sql-statement status="converted-closed">
SELECT CB.INCORPORATION_NUMBER AS INCORPORATION_NUMBER
FROM CORPORATE_BODY CB
WHERE CB.TRADING_STATUS_TYPE_ID = 5
  AND CB.ACTION_CODE_DATE >= TO_DATE('30-DEC-2009', 'DD-MON-YYYY')
  AND (SUBSTR(CB.INCORPORATION_NUMBER, 1, 2) != 'SE'
    OR SUBSTR(CB.INCORPORATION_NUMBER, 1, 2) = 'SE' AND CB.TRADING_STATUS_SUB_TYPE_ID = 3
    OR CB.ACTION_CODE_TYPE_ID = 9100 AND CB.TRADING_STATUS_SUB_TYPE_ID = 2)
    </sql-statement>
    <sql-statement status="receivership">
SELECT CB.INCORPORATION_NUMBER AS INCORPORATION_NUMBER
FROM CORPORATE_BODY CB
WHERE EXISTS(SELECT 1
             FROM INSOLVENCY_CASE IC
             WHERE CB.CORPORATE_BODY_ID = IC.CORPORATE_BODY_ID
               AND (CB.ACTION_CODE_TYPE_ID = 7301 AND IC.INSOLVENCY_CASE_TYPE_ID = 5
                 OR CB.ACTION_CODE_TYPE_ID = 7302 AND IC.INSOLVENCY_CASE_TYPE_ID IN (6, 16)
                 OR CB.ACTION_CODE_TYPE_ID = 7701 AND IC.INSOLVENCY_CASE_TYPE_ID IN (5, 6, 16)))
   OR SUBSTR(CB.INCORPORATION_NUMBER, 1, 2) IN ('SC', 'SA', 'SF', 'SL', 'SZ', 'SP', 'SO', 'SR', 'GS')
    AND EXISTS(SELECT 1
               FROM INSOLVENCY_CASE IC
               WHERE CB.CORPORATE_BODY_ID = IC.CORPORATE_BODY_ID
                 AND (CB.ACTION_CODE_TYPE_ID = 7301 AND IC.INSOLVENCY_CASE_TYPE_ID IN (6, 16)
                   OR CB.ACTION_CODE_TYPE_ID = 7302 AND IC.INSOLVENCY_CASE_TYPE_ID = 5))
    </sql-statement>
      <sql-statement status="administration">
SELECT CB.INCORPORATION_NUMBER AS INCORPORATION_NUMBER
FROM CORPORATE_BODY CB
WHERE EXISTS(SELECT 1
             FROM INSOLVENCY_CASE IC
             WHERE CB.CORPORATE_BODY_ID = IC.CORPORATE_BODY_ID
               AND IC.INSOLVENCY_CASE_END_DATE > SYSDATE
               AND (IC.INSOLVENCY_CASE_TYPE_ID = 13
                 OR IC.INSOLVENCY_CASE_TYPE_ID = 7 AND CB.ACTION_CODE_TYPE_ID = 7305))
      </sql-statement>
      <sql-statement status="voluntary-arrangement">
SELECT CB.INCORPORATION_NUMBER AS INCORPORATION_NUMBER
FROM CORPORATE_BODY CB
WHERE EXISTS(SELECT 1
             FROM INSOLVENCY_CASE IC
             WHERE CB.CORPORATE_BODY_ID = IC.CORPORATE_BODY_ID
               AND IC.INSOLVENCY_CASE_END_DATE > SYSDATE
               AND IC.INSOLVENCY_CASE_TYPE_ID = 8)
      </sql-statement>
  </status-classification-queries>
</sql-statements>