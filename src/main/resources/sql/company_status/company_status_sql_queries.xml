<sql-statements>
  <valid-companies-query>
    <sql-statement status="active">
      SELECT cb.Incorporation_Number as incorporation_number
      FROM chipstab.corporate_body cb
      WHERE (cb.trading_status_type_id IN (1, 2)
      OR (cb.action_code_date >= TO_DATE('20100101', 'YYYYMMDD') AND cb.action_code_type_id >=
      9000))
      UNION ALL
      SELECT incorporation_number
      from chipstab.corporate_body cb
      inner join chipstab.transaction trans on TRANS.CORPORATE_BODY_ID=CB.CORPORATE_BODY_ID
      where TRANS.TRANSACTION_TYPE_ID in (541,542) and transaction_status_type_id=9
      and transaction_status_date = to_date('05/01/2010','dd/mm/yyyy')
    </sql-statement>
  </valid-companies-query>
  <status-classification-queries>
    <sql-statement status="dissolved">
      SELECT INCORPORATION_NUMBER as incorporation_number
      FROM CORPORATE_BODY
      WHERE ACTION_CODE_TYPE_ID = 9000
      AND TRADING_STATUS_TYPE_ID = 3
      AND ACTION_CODE_DATE >= TO_DATE ('30-DEC-2009','DD-MON-YYYY')
    </sql-statement>
    <sql-statement status="liquidation">
      SELECT DISTINCT INCORPORATION_NUMBER as incorporation_number
      FROM CORPORATE_BODY CB
      WHERE CB.ACTION_CODE_TYPE_ID IN (7001, 7002, 7101, 7401, 7402, 7403)
      OR (ACTION_CODE_TYPE_ID = 7701
      AND EXISTS (SELECT 1 FROM INSOLVENCY_CASE IC
      WHERE CB.CORPORATE_BODY_ID = IC.CORPORATE_BODY_ID
      AND INSOLVENCY_CASE_END_DATE > SYSDATE
      AND INSOLVENCY_CASE_TYPE_ID IN (1, 2, 3)))
      ORDER BY INCORPORATION_NUMBER ASC
    </sql-statement>
  </status-classification-queries>
</sql-statements>